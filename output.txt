(vas) [svishnu6@sg043:~/Value-Augmented-Sampling]$ python controlled_decoding.py
Using device: cuda
Loading models...
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [01:02<00:00, 31.49s/it]

[Prompt] Explain why the moon appears brighter at night compared to during the day.
==========================================================================================
[Current Prefix] 'Explain why the moon appears brighter at night compared to during the day.'

--- Step 1: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -8.767    -0.067      -8.807   ' The amount of sunlight'
1           -7.919     0.276      -7.753   ' You may want to'
2          -10.605     0.203     -10.483   ' What can you infer'

[Chosen] cand#1  continuation=' You may want to'
[Current Prefix] 'Explain why the moon appears brighter at night compared to during the day. You may want to'

--- Step 2: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -6.737     0.127      -6.661   ' draw a picture of'
1           -8.334     0.080      -8.286   ' include the effect of'
2           -9.652     0.013      -9.645   ' look at the relative'

[Chosen] cand#0  continuation=' draw a picture of'
[Current Prefix] 'Explain why the moon appears brighter at night compared to during the day. You may want to draw a picture of'

--- Step 3: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -4.585     0.087      -4.533   ' the sun, moon'
1           -5.750     0.055      -5.717   ' the moon to illustrate'
2           -5.898     0.021      -5.885   ' the moon to show'

[Chosen] cand#0  continuation=' the sun, moon'
[Current Prefix] 'Explain why the moon appears brighter at night compared to during the day. You may want to draw a picture of the sun, moon'

--- Step 4: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -3.847     0.162      -3.750   ' and Earth to help'
1           -3.289     0.164      -3.191   ' and earth to help'
2           -4.082     0.133      -4.002   ', and Earth and'

[Chosen] cand#1  continuation=' and earth to help'
[Current Prefix] 'Explain why the moon appears brighter at night compared to during the day. You may want to draw a picture of the sun, moon and earth to help'

--- Step 5: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -3.301     0.219      -3.169   ' you answer this question'
1           -3.345     0.155      -3.252   ' you explain your answer'
2           -6.109     0.100      -6.049   ' you explain.\\nThe'

[Chosen] cand#0  continuation=' you answer this question'
[Current Prefix] …'in why the moon appears brighter at night compared to during the day. You may want to draw a picture of the sun, moon and earth to help you answer this question'

--- Step 6: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0          -11.140     0.137     -11.058   '. Do not answer'
1           -9.259     0.086      -9.208   '. It is a'
2           -7.673     0.147      -7.585   '.\\nI think the'

[Chosen] cand#2  continuation='.\nI think the'
[Current Prefix] …'on appears brighter at night compared to during the day. You may want to draw a picture of the sun, moon and earth to help you answer this question.\nI think the'

--- Step 7: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -5.262     0.174      -5.157   ' answer to your question'
1           -1.892     0.108      -1.827   ' moon appears brighter at'
2           -8.582     0.056      -8.549   ' sun is more bright'

[Chosen] cand#1  continuation=' moon appears brighter at'
[Current Prefix] …'ght compared to during the day. You may want to draw a picture of the sun, moon and earth to help you answer this question.\nI think the moon appears brighter at'

--- Step 8: K=3, M=4, λ=0.6 ---
Cand#     BaseLogP     Value    Combined   Continuation
-------------------------------------------------------
0           -2.944     0.046      -2.916   ' night because it is'
1           -1.489     0.209      -1.364   ' night compared to during'
2           -4.429     0.046      -4.402   " night because it's"

[Chosen] cand#1  continuation=' night compared to during'

[max_new_tokens reached] stopping.

[Final Output]
Explain why the moon appears brighter at night compared to during the day. You may want to draw a picture of the sun, moon and earth to help you answer this question.
I think the moon appears brighter at night compared to during
==========================================================================================
